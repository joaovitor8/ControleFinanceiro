// Banco de Dados do Prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}


// ---------------------------------------------



// Tabela do Usuario
model User {
  id String @id
  email String @unique
  name String?
  date DateTime @default(now()) // Quando o usuario se cadastro ( Entrou pela primeira vez )

  // Lista de conexões
  userRoles User_Roles[]
  AccountsPayable AccountsPayable[]
  // AccountsReceivable AccountsReceivable[]
  Goal Goal[]
}


// Tabela de Funções ( Se o usuario é Admin, Premium ou Gratis )
model Roles {
  id  Int @id @default(autoincrement())
  name String @unique

  // Lista de conexões
  userRoles User_Roles[]
}


// Tabela de ligação entre Usuarios e Funções
model User_Roles {
  userId String  // String porque o ID do User é String
  roleId Int     // Int porque o ID do Role é Int

  // Relações
  // O campo 'userId' e 'roleId' desta tabela aponta para o campo 'id' da tabela User e Roles"
  user   User @relation(fields: [userId], references: [id])
  role   Roles @relation(fields: [roleId], references: [id])

  // Chave Primária Composta
  @@id([userId, roleId]) // Não pode existir uma linha repetida com o mesmo par userId + roleId
}


// ---


// Contas a Pagar
model AccountsPayable {
  id String   @id @default(uuid()) // Gera um ID único automático
  name String
  amount Decimal // Valor

  category String   // "Assinatura", "Lazer", etc.

  frequency String  // "Mensal", "Anual"
  nextDate DateTime // Quando vence
  
  date DateTime @default(now()) // Data que aconteceu

  // Dono (Relacionamento 1-N)
  userId String
  user User     @relation(fields: [userId], references: [id])
}


// Metas de Economia
model Goal {
  id        String   @id @default(uuid())
  userId    String
  name      String
  target    Float    // Valor Alvo
  current   Float    @default(0) // Valor Atual
  icon      String   @default("target") // plane, car, home, shield, target
  color     String   @default("emerald") // emerald, blue, amber, purple
  createdAt DateTime @default(now())

  user      User     @relation(fields: [userId], references: [id])
}



// Contas a Receber
// model AccountsReceivable{
//   id String   @id @default(uuid()) // Gera um ID único automático
//   name String
//   amount Decimal


//   // Dono (Relacionamento 1-N)
//   userId String
//   user User     @relation(fields: [userId], references: [id])
// }
