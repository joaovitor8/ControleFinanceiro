
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// ---------------------------------------------


// Tabela do Usuario
model User {
  id String @id
  email String @unique
  name String?
  date DateTime @default(now()) // Quando o usuario se cadastro ( Entrou pela primeira vez )

  userRoles User_Roles[] // Lista de conexões na tabela pivô
  ContasPagar ContaPagar[]
}


// Tabela de Funções ( Se o usuario é Admin, Premium ou Gratis )
model Roles {
  id  Int @id @default(autoincrement())
  name String @unique

  userRoles User_Roles[] // Lista de conexões na tabela pivô
}


// Tabela de ligação entre Usuarios e Funções
model User_Roles {
  userId String  // String porque o ID do User é String
  roleId Int     // Int porque o ID do Role é Int

  // Relações
  // O campo 'userId' e 'roleId' desta tabela aponta para o campo 'id' da tabela User e Roles"
  user   User @relation(fields: [userId], references: [id])
  role   Roles @relation(fields: [roleId], references: [id])

  // Chave Primária Composta
  @@id([userId, roleId]) // Não pode existir uma linha repetida com o mesmo par userId + roleId
}

// ---



model ContaPagar {
  id String   @id @default(uuid()) // Gera um ID único automático
  name String
  

  
  amount      Decimal  // Use Decimal para dinheiro!
  
  // Categorização (Essencial para seus gráficos)
  type        String   // "INCOME" ou "EXPENSE"
  category    String   // "Assinatura", "Lazer", etc.
  
  // --- A PARTE DA RECORRÊNCIA (Para seu formulário AddExpenses) ---
  // Note o "?" que torna o campo opcional (nem tudo é recorrente)
  isRecurring Boolean  @default(false)
  frequency   String?  // "Mensal", "Anual"
  nextDate    DateTime? // Quando vence a próxima?
  
  // Auditoria
  date        DateTime @default(now()) // Data que aconteceu

  // Dono (Relacionamento 1-N)
  userId      String
  user        User     @relation(fields: [userId], references: [id])
}
